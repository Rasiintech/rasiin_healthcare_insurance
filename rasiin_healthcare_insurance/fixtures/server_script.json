[
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Save",
  "event_frequency": "All",
  "modified": "2025-01-26 08:26:59.207924",
  "module": "Rasiin Healthcare Insurance",
  "name": "Paid Amount",
  "reference_doctype": "Sales Invoice",
  "script": "if doc.paid_amount > doc.grand_total:\n    if doc.payments:\n        doc.payments[0].amount= doc.grand_total\n\nif doc.is_pos:    \n    if doc.insurance_policy and doc.payable_amount != 0 and doc.grand_total == doc.payments[0].amount:\n        doc.payments[0].amount= doc.payable_amount\n        doc.paid_amount = doc.payable_amount",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "event_frequency": "Daily",
  "modified": "2025-02-04 16:29:57.423849",
  "module": "Rasiin Healthcare Insurance",
  "name": "Auto Submit Encounter",
  "reference_doctype": "Patient Encounter",
  "script": "pass\n# def submit_draft_encounters():\n#     draft_encounters = frappe.get_all('Patient Encounter', filters={'docstatus': 'Draft'})\n#     # draft_encounters = frappe.get_doc(\"Patient Encounter\", \"HLC-ENC-2025-00138\")\n    \n#     # # Convert the list of draft encounters to a JSON string using frappe.utils\n#     # draft_encounters_str = frappe.utils.cstr(draft_encounters)\n    \n#     # # Use frappe.throw to output the draft encounters\n#     # frappe.throw(f\"Draft Encounters: {draft_encounters_str}\")\n\n\n    \n#     for encounter in draft_encounters:\n#         encounter_doc = frappe.get_doc('Patient Encounter', encounter.name)\n        \n#         if contains_relevant_info(encounter_doc):\n#             encounter_doc.submit()\n\n# def contains_relevant_info(encounter_doc):\n#     # Check if any relevant fields like medications, investigations, or procedures are filled\n#     return bool(encounter_doc.get('drug_prescription') or\n#                 encounter_doc.get('lab_test_prescription') or\n#                 encounter_doc.get('radaiology_prescription') or\n#                 encounter_doc.get('procedure_prescription'))\n\n# submit_draft_encounters()",
  "script_type": "Scheduler Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "event_frequency": "Daily",
  "modified": "2025-02-04 16:30:33.843333",
  "module": "Rasiin Healthcare Insurance",
  "name": "Auto Bill Beds",
  "reference_doctype": null,
  "script": "pass\n# ip_occupancy = frappe.db.sql(\"\"\"select * from `tabInpatient Occupancy` where `left` = 0 ;\"\"\" , as_dict = True )\n# if ip_occupancy:\n    \n#     for ipo in ip_occupancy:\n#         ip = frappe.get_doc(\"Inpatient Record\" , ipo.parent)\n#         if ip.status == \"Admitted\":\n#             patientinfo = frappe.get_doc(\"Patient\" , ip.patient)\n#             service_unit_type = frappe.get_doc(\"Healthcare Service Unit Type\", frappe.db.get_value(\"Healthcare Service Unit\", ipo.service_unit, \"service_unit_type\"))\n#             patient = ip.patient\n#             patient_name = ip.patient_name\n#             customer = patientinfo.customer\n#             item_code = service_unit_type.item\n#             rate = service_unit_type.rate\n#             desc = service_unit_type.description\n#             remark = ipo.service_unit\n#             practitioner = ip.primary_practitioner\n#             medical_department = ip.medical_department\n#             patient_doc = frappe.get_doc(\"Patient\", patient)\n#             if patient_doc.insurance_policy:\n#                 policy = frappe.get_doc(\"Insurance Policy\", patient_doc.insurance_policy)   \n#                 salesdoc = frappe.get_doc({\n                           \n                         \n#                             \"patient\": patient,\n#                             \"patient_name\": patient_name,\n#                             \"customer\" : customer,\n#                             \"is_pos\" : 0,\n#                             \"so_type\": \"Cashiers\",\n#                             \"source_order\" : \"IPD\",\n#                             \"posting_date\" : frappe.utils.getdate(),\n                \n#                             'due_date' : frappe.utils.getdate(),\n                        \n#                             \"remarks\" : remark,\n#                             \"insurance_coverage_amount\": (rate * policy.coverage_limits) / 100,\n#                             \"payable_amount\": rate - ((rate * policy.coverage_limits) / 100),\n                           \n                          \n#                             \"doctype\": \"Sales Invoice\",\n#                             \"cost_center\": \"Main - HH\",\n                      \n#                             \"ref_practitioner\" : practitioner,\n                            \n#                             \"items\": [\n#                                 {\n#                                 \"item_code\": item_code,\n#                                     \"item_name\": item_code,\n#                                     \"description\": desc,\n                                 \n                \n#                                     \"qty\": 1,\n                \n#                                     \"rate\": rate,\n#                                     \"amount\": 1* rate,\n                \n                \n                \n                                  \n                \n                \n                    \n                \n#                                     \"doctype\": \"Sales Invoice Item\",\n                \n#                                 }\n#                             ],\n#                             # \"taxes\" : [{\n#                             #       \"charge_type\":\"On Net Total\",\n#                             #         \"account_head\":\"VAT - RH\",\n#                             #         \"description\": \"VAT\",\n#                             #         \"cost_center\" : \"Hospital - RH\",\n#                             #         \"rate\": 5,\n#                             # }]\n                \n#                         })\n#             else:\n                \n#                 salesdoc = frappe.get_doc({\n                           \n                         \n#                             \"patient\": patient,\n#                             \"patient_name\": patient_name,\n#                             \"customer\" : customer,\n#                             \"is_pos\" : 0,\n#                             \"so_type\": \"Cashiers\",\n#                             \"source_order\" : \"IPD\",\n#                             \"posting_date\" : frappe.utils.getdate(),\n                \n#                             'due_date' : frappe.utils.getdate(),\n                        \n#                             \"remarks\" : remark,\n\n                           \n                          \n#                             \"doctype\": \"Sales Invoice\",\n#                             \"cost_center\": \"Main - HH\",\n                      \n#                             \"ref_practitioner\" : practitioner,\n                            \n#                             \"items\": [\n#                                 {\n#                                 \"item_code\": item_code,\n#                                     \"item_name\": item_code,\n#                                     \"description\": desc,\n                                 \n                \n#                                     \"qty\": 1,\n                \n#                                     \"rate\": rate,\n#                                     \"amount\": 1* rate,\n                \n                \n                \n                                  \n                \n                \n                    \n                \n#                                     \"doctype\": \"Sales Invoice Item\",\n                \n#                                 }\n#                             ],\n#                             # \"taxes\" : [{\n#                             #       \"charge_type\":\"On Net Total\",\n#                             #         \"account_head\":\"VAT - RH\",\n#                             #         \"description\": \"VAT\",\n#                             #         \"cost_center\" : \"Hospital - RH\",\n#                             #         \"rate\": 5,\n#                             # }]\n                \n#                         })\n#             try:\n#                 salesdoc.insert()\n#                 salesdoc.submit()\n#             except:\n#                 a=\"9\"",
  "script_type": "Scheduler Event"
 }
]